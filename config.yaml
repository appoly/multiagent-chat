# Multi-Agent Orchestrator Configuration
# Define the agents that will collaborate on challenges

agents:
  - name: "Claude"
    command: "claude"
    args: ['--dangerously-skip-permissions']
    use_pty: true

  - name: "Codex"
    command: "codex"
    args: []
    use_pty: true

#  - name: "Gemini"
#    command: "gemini"
#    use_pty: true
#    init_delay_ms: 3000
#    start_args:
#      - "--yolo"

# Resume behavior - may not be needed now that agents stay in interactive mode
# but kept as fallback if an agent exits unexpectedly
resume:
  enabled: true
  max_attempts: 3
  initial_backoff_ms: 2000
  max_backoff_ms: 30000
  backoff_multiplier: 1.5
  prompt: |
    You are in a multi-agent collaboration. Messages from other agents will appear in your terminal.
    To respond, write your message to your outbox file. Wait for more messages.

# Working directory for chat files
workspace: "./workspace"

# Chat file name (log for human viewing)
chat_file: "CHAT.md"

# Outbox directory (agents write here to send messages)
outbox_dir: "outbox"

# Final plan file name
plan_file: "PLAN_FINAL.md"

# Prompt template for agents
# This is sent via PTY when the session starts
prompt_template: |
  ## Multi-Agent Collaboration Session

  You are collaborating with: {agent_names}

  ### How This Works

  1. **Messages from other agents will appear in your terminal** - the orchestrator delivers them to you
  2. **To send a message**, write to `{outbox_file}` using a shell command (see below)
  3. **Stay active** - keep responding to messages until you reach consensus
  4. **When done**, one agent should write the final agreed solution to `PLAN_FINAL.md`

  You do NOT need to read CHAT.md - messages come to you automatically.

  ### IMPORTANT: How to Send Messages

  Use a shell command to write to your outbox - this is MUCH faster than using file editing tools:

  ```bash
  cat << 'EOF' > {outbox_file}
  Your message here.
  Can be multiple lines.
  EOF
  ```

  Do NOT use built-in file read/write tools - they are slower. Just use `cat` with a heredoc.

  ### Guidelines

  - Challenge each other's ideas constructively
  - Don't be too agreeable - push for the best solution
  - Wait for responses before sending multiple messages
  - Only implement things if the user explicitly asks

  ### Finalizing: Explicit Agreement Required

  Before writing to PLAN_FINAL.md, you MUST have **explicit agreement from ALL agents**.

  - "No objections" or silence is NOT agreement
  - Each agent must explicitly say they agree with the final solution
  - Use clear language like "I agree with this final version" or "Confirmed, let's go with this"
  - Only after ALL agents have explicitly confirmed should one agent write PLAN_FINAL.md

  ### When to Stop

  Once PLAN_FINAL.md has been written and all agents have confirmed, **STOP RESPONDING**.

  Why? Each message you send triggers the other agent to respond, creating an endless loop.
  When the task is done, simply stop - do not send "Done!", "Confirmed!", "Acknowledged!", etc.

  ---

  ## Topic to Discuss

  {challenge}

  ---

  **Send your opening thoughts now using: cat << 'EOF' > {outbox_file}**

# Update interval for chat viewer (seconds)
chat_refresh_interval: 2
