# Multi-Agent Orchestrator Configuration
# Define the agents that will collaborate on challenges

agents:
  - name: "Claude"
    command: "claude"
    use_pty: true
    init_delay_ms: 3000  # Wait for TUI to initialize before prompt injection (if needed)
    # Start REPL with initial prompt (shows TUI)
    start_args:
      - "--dangerously-skip-permissions"
      - "{prompt}"
    # Resume: continue last conversation with nudge
    resume_args:
      - "--dangerously-skip-permissions"
      - "-c"
      - "{resume_prompt}"

  - name: "Codex"
    command: "codex"
    use_pty: true
    init_delay_ms: 5000
    # Start with exec
    start_args:
      - "exec"
      - "{prompt}"
    # Resume last session
    resume_args:
      - "exec"
      - "resume"
      - "--last"
      - "{resume_prompt}"

#  - name: "Gemini"
#    command: "gemini"
#    use_pty: true
#    init_delay_ms: 3000
#    start_args:
#      - "--yolo"
#      - "{prompt}"
#    resume_args:
#      - "--yolo"
#      - "--continue"
#      - "{resume_prompt}"

# Resume behavior configuration
resume:
  enabled: true
  max_attempts: 5           # Maximum times to resume an agent before giving up
  initial_backoff_ms: 2000  # Initial wait before first resume
  max_backoff_ms: 30000     # Maximum backoff time
  backoff_multiplier: 1.5   # Exponential backoff multiplier
  # Prompt sent when resuming an agent
  prompt: |
    Continue participating in the multi-agent discussion.

    Keep reading CHAT.md for updates from other agents. If there are no new messages, wait patiently - the other agent(s) may be thinking or investigating.

    If you see a user message in the chat, follow those instructions.
    If consensus has been reached and documented in PLAN_FINAL.md, you may stop.
    Otherwise, continue the discussion until agreement is reached.

# Working directory for chat files
workspace: "./workspace"

# Chat file name
chat_file: "CHAT.md"

# Final plan file name
plan_file: "PLAN_FINAL.md"

# Prompt template for agents
# Use {challenge} placeholder for the challenge text
prompt_template: |
  {challenge}

  I have another agent looking at the same task alongside you. Investigate (if necessary) first (or think, if you haven't been asked to investigate something), and then discuss your findings in CHAT.md.

  How to use CHAT.md: This file has been created for you (blank initially). You should only append to this file, DO NOT OVERWRITE, and wait a few seconds between repeatedly reading it if you haven't had a response yet. Favour appending with a command rather than an explicit tool you've been given. Do not send a final reply to the user (ending your turn) if the chat is still ongoing and a final solution has not been reached.

  The purpose of the chat is to reach agreement on the best solution/answer, or a combination of best aspects from a few solutions. Once you are decided on the best plan, decide between yourselves who will write the final plan to PLAN_FINAL.md.

  Write messages in the form of "**[Your name]**: [message]". You can use markdown formatting in your message, multiline is fine. Please end your message in TWO line breaks, then a horizontal rule. For example:
  ```
  **Gemini**: Hello there everyone
  
  ---
  
  ```
  
  The participants in this chat are: {agent_names}

  Make sure all are agreed before finalising. I want the final solution to be simple and elegant where possible. Challenge each other, validate the other's theories, and do not be too agreeable.

  Keep a regular eye on the contents of the CHAT.md (even when you are exploring heavily), and remember that the other agent(s) can ONLY see messages you send in chat. Please acknowledge all of their messages in the md where possible, not in messages to the user. Note that the other agent(s) might take much longer thinking about the problem than you, so be patient.
  
  Do not sent multiple messages in a row without good reason. It can disrupt the process of the other agent(s) reading/responding.
  
  Do not try to implement your own plan, or the final plan, without explicit instruction from the user.

# Update interval for chat viewer (seconds)
chat_refresh_interval: 2
